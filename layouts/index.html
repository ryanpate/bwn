{{ define "head" }}

<!-- CollectionPage Schema for Homepage -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "BlockWire News - Crypto News & Market Intelligence",
  "description": {{ .Site.Params.description | jsonify }},
  "url": {{ .Site.BaseURL | jsonify }},
  "publisher": {
    "@type": "Organization",
    "name": {{ .Site.Title | jsonify }},
    "url": {{ .Site.BaseURL | jsonify }},
    "logo": {
      "@type": "ImageObject",
      "url": {{ (index .Site.Params.images 0 | absURL) | jsonify }}
    }
  },
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": [
      {{ range $index, $page := (first 10 (where .Site.RegularPages "Section" "news")) }}
      {{ if $index }},{{ end }}
      {
        "@type": "ListItem",
        "position": {{ add $index 1 }},
        "url": {{ $page.Permalink | jsonify }},
        "name": {{ $page.Title | jsonify }}
      }
      {{ end }}
    ]
  },
  "inLanguage": "en-US",
  "isAccessibleForFree": true
}
</script>

<style>
    /* Hero Section */
    .hero {
        background: linear-gradient(135deg,
                rgba(139, 92, 246, 0.3) 0%,
                rgba(124, 58, 237, 0.2) 25%,
                rgba(91, 33, 182, 0.15) 50%,
                rgba(236, 72, 153, 0.2) 75%);
        border-radius: 20px;
        padding: 4rem 2rem;
        margin: 2rem auto;
        max-width: var(--max-width);
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background:
            linear-gradient(rgba(255, 255, 255, 0.01) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.01) 1px, transparent 1px);
        background-size: 60px 60px;
        opacity: 0.4;
    }

    .hero-content {
        position: relative;
        z-index: 1;
    }

    .hero-title {
        font-size: 3.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, #a78bfa, #ec4899);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 1rem;
        letter-spacing: -0.03em;
    }

    .hero-subtitle {
        font-size: 1.25rem;
        color: var(--text-muted);
        margin-bottom: 3rem;
    }

    .hero-badges {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-bottom: 3rem;
        flex-wrap: wrap;
    }

    .badge {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 0.5rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        backdrop-filter: blur(10px);
    }

    /* Price Grid */
    .price-grid {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 1rem;
        margin: 3rem 0;
        min-height: 120px;
    }

    .price-card {
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        padding: 1.25rem;
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .price-card:hover {
        background: rgba(139, 92, 246, 0.15);
        transform: translateY(-4px);
        box-shadow: 0 12px 30px rgba(139, 92, 246, 0.25);
    }

    /* Loading skeleton animation */
    .price-card.loading {
        background: linear-gradient(90deg,
                rgba(255, 255, 255, 0.05) 25%,
                rgba(255, 255, 255, 0.1) 50%,
                rgba(255, 255, 255, 0.05) 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }

    @keyframes loading {
        0% {
            background-position: 200% 0;
        }

        100% {
            background-position: -200% 0;
        }
    }

    .price-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
    }

    .coin-name {
        color: var(--text-muted);
        font-size: 0.85rem;
    }

    .coin-symbol {
        color: var(--primary);
        font-weight: 600;
        font-size: 0.9rem;
    }

    .price-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: white;
        margin-bottom: 0.25rem;
    }

    .price-change {
        font-size: 0.9rem;
        font-weight: 500;
    }

    .price-change.positive {
        color: #10b981;
    }

    .price-change.negative {
        color: #ef4444;
    }

    .price-error {
        grid-column: 1 / -1;
        text-align: center;
        color: var(--text-muted);
        padding: 2rem;
    }

    .retry-button {
        margin-top: 1rem;
        padding: 0.5rem 1rem;
        background: rgba(139, 92, 246, 0.2);
        border: 1px solid rgba(139, 92, 246, 0.4);
        border-radius: 8px;
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .retry-button:hover {
        background: rgba(139, 92, 246, 0.3);
        transform: translateY(-2px);
    }

    /* CTA Section */
    .cta-container {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
    }

    .cta-button {
        padding: 1rem 2rem;
        font-size: 1rem;
        font-weight: 600;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s ease;
    }

    .cta-primary {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        color: white;
        box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
    }

    .cta-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(139, 92, 246, 0.5);
    }

    .cta-secondary {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
    }

    .cta-secondary:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-2px);
    }

    /* News Section */
    .news-section {
        margin: 4rem 0;
    }

    .section-header {
        text-align: center;
        margin-bottom: 3rem;
    }

    .section-title {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .section-subtitle {
        color: var(--text-muted);
    }

    .articles-grid {
        display: grid;
        gap: 1.5rem;
    }

    .article-card {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 1.5rem;
        transition: all 0.3s ease;
        text-decoration: none;
        color: inherit;
        display: block;
    }

    .article-card:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateX(4px);
        box-shadow: 0 10px 40px rgba(139, 92, 246, 0.15);
    }

    .article-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        line-height: 1.4;
    }

    .article-excerpt {
        color: var(--text-muted);
        line-height: 1.6;
        margin-bottom: 1rem;
    }

    .article-meta {
        display: flex;
        gap: 1rem;
        color: rgba(255, 255, 255, 0.5);
        font-size: 0.875rem;
    }

    /* Ad Styles */
    .homepage-ad,
    .in-feed-ad {
        margin: 2rem 0;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        min-height: 100px;
        position: relative;
    }

    .homepage-ad::before,
    .in-feed-ad::before {
        content: 'Advertisement';
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
        background: #0a0e27;
        padding: 0 0.5rem;
        font-size: 0.75rem;
        color: rgba(255, 255, 255, 0.3);
        text-transform: uppercase;
        letter-spacing: 0.1em;
    }

    /* Responsive */
    @media (max-width: 1200px) {
        .price-grid {
            grid-template-columns: repeat(4, 1fr);
        }
    }

    @media (max-width: 900px) {
        .price-grid {
            grid-template-columns: repeat(3, 1fr);
        }

        .hero-title {
            font-size: 2.5rem;
        }
    }

    @media (max-width: 600px) {
        .price-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .hero-title {
            font-size: 2rem;
        }

        .hero {
            padding: 2rem 1rem;
        }
    }
</style>
{{ end }}

{{ define "main" }}
<div class="container">
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">REAL-TIME CRYPTO INTELLIGENCE</h1>
            <p class="hero-subtitle">Your trusted source for breaking crypto news and market analysis</p>

            <div class="hero-badges">
                <div class="badge">
                    <span style="color: #10b981;">‚óè</span>
                    24/7 Coverage
                </div>
                <div class="badge">
                    üìä Deep Analysis
                </div>
                <div class="badge">
                    ‚ö° Breaking News
                </div>
            </div>

            <!-- Dynamic Price Ticker Grid -->
            <div class="price-grid" id="hero-price-grid">
                <!-- Loading skeletons will be shown initially -->
                <div class="price-card loading">
                    <div class="price-header">
                        <span class="coin-name">Loading...</span>
                        <span class="coin-symbol">...</span>
                    </div>
                    <div class="price-value">--</div>
                    <div class="price-change">--</div>
                </div>
                <div class="price-card loading">
                    <div class="price-header">
                        <span class="coin-name">Loading...</span>
                        <span class="coin-symbol">...</span>
                    </div>
                    <div class="price-value">--</div>
                    <div class="price-change">--</div>
                </div>
                <div class="price-card loading">
                    <div class="price-header">
                        <span class="coin-name">Loading...</span>
                        <span class="coin-symbol">...</span>
                    </div>
                    <div class="price-value">--</div>
                    <div class="price-change">--</div>
                </div>
                <div class="price-card loading">
                    <div class="price-header">
                        <span class="coin-name">Loading...</span>
                        <span class="coin-symbol">...</span>
                    </div>
                    <div class="price-value">--</div>
                    <div class="price-change">--</div>
                </div>
                <div class="price-card loading">
                    <div class="price-header">
                        <span class="coin-name">Loading...</span>
                        <span class="coin-symbol">...</span>
                    </div>
                    <div class="price-value">--</div>
                    <div class="price-change">--</div>
                </div>
            </div>

            <div class="cta-container">
                <a href="/subscribe/" class="cta-button cta-primary">
                    üìß Get Daily Briefs
                </a>
                <a href="/news/" class="cta-button cta-secondary">
                    üì∞ Latest Updates
                </a>
            </div>
        </div>
    </section>

    <!-- News Section -->
    <section class="news-section">
        <div class="section-header">
            <h2 class="section-title">Latest Crypto News</h2>
            <p class="section-subtitle">Breaking stories, market analysis, and expert insights</p>
        </div>

        <!-- Ad placement - Display Ad -->
        <div class="homepage-ad">
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5523870768931777"
                data-ad-slot="9791794062" data-ad-format="horizontal" data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <div class="articles-grid">
            {{ $counter := 0 }}
            {{ range first 10 (where .Site.RegularPages "Section" "news") }}
            {{ $counter = add $counter 1 }}
            {{ if eq (mod $counter 3) 0 }}
            <!-- Multiplex ad every 3 articles -->
            <div class="in-feed-ad">
                <ins class="adsbygoogle" style="display:block" data-ad-format="fluid"
                    data-ad-layout-key="-6t+ed+2i-1n-4w" data-ad-client="ca-pub-5523870768931777"
                    data-ad-slot="7860314035"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            {{ end }}

            <a href="{{ .Permalink }}" class="article-card">
                <h3 class="article-title">{{ .Title }}</h3>
                <p class="article-excerpt">{{ .Summary | truncate 150 }}</p>
                <div class="article-meta">
                    <span>{{ .Date.Format "Jan 2, 2006" }}</span>
                    <span>{{ .ReadingTime }} min read</span>
                </div>
            </a>
            {{ end }}
        </div>
    </section>
</div>

<script>
    // Crypto configuration for CoinCap API
    const HERO_CRYPTOS = [
        { symbol: 'BTC', name: 'Bitcoin', coincapId: 'bitcoin' },
        { symbol: 'ETH', name: 'Ethereum', coincapId: 'ethereum' },
        { symbol: 'SOL', name: 'Solana', coincapId: 'solana' },
        { symbol: 'BNB', name: 'BNB', coincapId: 'binance-coin' },
        { symbol: 'XRP', name: 'XRP', coincapId: 'xrp' },
        { symbol: 'ADA', name: 'Cardano', coincapId: 'cardano' },
        { symbol: 'AVAX', name: 'Avalanche', coincapId: 'avalanche' },
        { symbol: 'MATIC', name: 'Polygon', coincapId: 'polygon' },
        { symbol: 'DOT', name: 'Polkadot', coincapId: 'polkadot' },
        { symbol: 'LINK', name: 'Chainlink', coincapId: 'chainlink' }
    ];

    // Function to format price based on value
    function formatPrice(price) {
        const numPrice = parseFloat(price);
        if (numPrice >= 1000) {
            return numPrice.toLocaleString('en-US', {
                maximumFractionDigits: 0,
                minimumFractionDigits: 0
            });
        } else if (numPrice >= 1) {
            return numPrice.toLocaleString('en-US', {
                maximumFractionDigits: 2,
                minimumFractionDigits: 2
            });
        } else if (numPrice >= 0.01) {
            return numPrice.toLocaleString('en-US', {
                maximumFractionDigits: 4,
                minimumFractionDigits: 2
            });
        } else {
            return numPrice.toLocaleString('en-US', {
                maximumFractionDigits: 6,
                minimumFractionDigits: 4
            });
        }
    }

    // Function to fetch and display crypto prices using CoinCap API
    async function fetchHeroPrices() {
        const priceGrid = document.getElementById('hero-price-grid');

        try {
            // CoinCap API - more CORS friendly
            const ids = HERO_CRYPTOS.map(c => c.coincapId).join(',');
            const response = await fetch(`https://api.coincap.io/v2/assets?ids=${ids}`);

            if (!response.ok) {
                throw new Error('Failed to fetch from CoinCap');
            }

            const result = await response.json();
            const data = result.data;

            // Clear loading state
            priceGrid.innerHTML = '';

            // Create price cards
            HERO_CRYPTOS.forEach(crypto => {
                const coinData = data.find(d => d.id === crypto.coincapId);

                if (coinData) {
                    const price = parseFloat(coinData.priceUsd);
                    const change = parseFloat(coinData.changePercent24Hr);

                    const card = document.createElement('div');
                    card.className = 'price-card';
                    card.innerHTML = `
                    <div class="price-header">
                        <span class="coin-name">${crypto.name}</span>
                        <span class="coin-symbol">${crypto.symbol}</span>
                    </div>
                    <div class="price-value">${formatPrice(price)}</div>
                    <div class="price-change ${change >= 0 ? 'positive' : 'negative'}">
                        ${change >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(change).toFixed(2)}%
                    </div>
                `;

                    priceGrid.appendChild(card);
                }
            });

            console.log('Successfully fetched prices from CoinCap API');

        } catch (error) {
            console.error('Error fetching prices:', error);

            // Try alternative: CoinRanking API (also CORS-friendly)
            try {
                console.log('Trying CoinRanking API as fallback...');

                // CoinRanking symbols mapping
                const symbolsParam = HERO_CRYPTOS.map(c => c.symbol).join(',');
                const coinRankingResponse = await fetch(
                    `https://api.coinranking.com/v2/coins?symbols=${symbolsParam}&limit=10`,
                    {
                        headers: {
                            'Accept': 'application/json'
                        }
                    }
                );

                if (coinRankingResponse.ok) {
                    const coinRankingData = await coinRankingResponse.json();
                    const coins = coinRankingData.data.coins;

                    priceGrid.innerHTML = '';

                    HERO_CRYPTOS.forEach(crypto => {
                        const coin = coins.find(c => c.symbol === crypto.symbol);

                        if (coin) {
                            const price = parseFloat(coin.price);
                            const change = parseFloat(coin.change);

                            const card = document.createElement('div');
                            card.className = 'price-card';
                            card.innerHTML = `
                            <div class="price-header">
                                <span class="coin-name">${crypto.name}</span>
                                <span class="coin-symbol">${crypto.symbol}</span>
                            </div>
                            <div class="price-value">${formatPrice(price)}</div>
                            <div class="price-change ${change >= 0 ? 'positive' : 'negative'}">
                                ${change >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(change).toFixed(2)}%
                            </div>
                        `;

                            priceGrid.appendChild(card);
                        }
                    });

                    console.log('Successfully fetched prices from CoinRanking API');
                } else {
                    throw new Error('CoinRanking API also failed');
                }

            } catch (fallbackError) {
                console.error('All API attempts failed:', fallbackError);

                // Display static fallback prices
                const fallbackPrices = [
                    { symbol: 'BTC', name: 'Bitcoin', price: 68432, change: 2.3 },
                    { symbol: 'ETH', name: 'Ethereum', price: 4368, change: 1.8 },
                    { symbol: 'SOL', name: 'Solana', price: 142.50, change: -0.5 },
                    { symbol: 'BNB', name: 'BNB', price: 412.80, change: 3.2 },
                    { symbol: 'XRP', name: 'XRP', price: 0.58, change: 1.2 },
                    { symbol: 'ADA', name: 'Cardano', price: 0.52, change: -1.1 },
                    { symbol: 'AVAX', name: 'Avalanche', price: 28.45, change: 2.8 },
                    { symbol: 'MATIC', name: 'Polygon', price: 0.68, change: 1.5 },
                    { symbol: 'DOT', name: 'Polkadot', price: 5.82, change: -0.8 },
                    { symbol: 'LINK', name: 'Chainlink', price: 11.24, change: 3.5 }
                ];

                priceGrid.innerHTML = '';

                fallbackPrices.slice(0, 10).forEach(crypto => {
                    const card = document.createElement('div');
                    card.className = 'price-card';
                    card.innerHTML = `
                    <div class="price-header">
                        <span class="coin-name">${crypto.name}</span>
                        <span class="coin-symbol">${crypto.symbol}</span>
                    </div>
                    <div class="price-value">${formatPrice(crypto.price)}</div>
                    <div class="price-change ${crypto.change >= 0 ? 'positive' : 'negative'}">
                        ${crypto.change >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(crypto.change).toFixed(2)}%
                    </div>
                `;

                    priceGrid.appendChild(card);
                });

                console.log('Using static fallback prices');
            }
        }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function () {
        // Initial load
        fetchHeroPrices();

        // Refresh prices every 30 seconds
        setInterval(fetchHeroPrices, 30000);
    });
</script>
{{ end }}